(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk_activityRecharge","chunk-1d9f238a"],{"197f":function(e,t,a){"use strict";a("2ee7")},"2e1c":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-card",[a("div",{staticClass:"table-wrap"},[a("a-modal",{attrs:{visible:e.visible,destroyOnClose:"",footer:null},on:{cancel:function(t){e.visible=!1}}},[a("div",{staticClass:"apply-info"},[e._v("请选择批量审批状态")]),a("div",{staticClass:"apply-son",on:{click:function(t){return e.changeApplyState(0)}}},[e._v("保持为：待审批")]),a("div",{staticClass:"apply-son",on:{click:function(t){return e.changeApplyState(1)}}},[e._v("更新为：审批同意")]),a("div",{staticClass:"apply-son",on:{click:function(t){return e.changeApplyState(2)}}},[e._v("更新为：审批拒绝")])]),a("div",{staticClass:"tab-wall"},[a("div",{staticClass:"item",on:{click:function(t){return e.tabClick(null)}}},[a("div",{staticClass:"text",class:{"text-active":null==e.tabKey}},[e._v("全部")]),null==e.tabKey?a("span"):e._e()]),a("div",{staticClass:"item",on:{click:function(t){return e.tabClick(0)}}},[a("div",{staticClass:"text",class:{"text-active":0==e.tabKey}},[e._v("待审批")]),0==e.tabKey?a("span"):e._e()]),a("div",{staticClass:"item",on:{click:function(t){return e.tabClick(1)}}},[a("div",{staticClass:"text",class:{"text-active":1==e.tabKey}},[e._v("审批同意")]),1==e.tabKey?a("span"):e._e()])]),e.selectedAll.length>0?a("div",{staticClass:"alert-wall"},[a("div",[e._v("已选择"+e._s(e.selectedAll.length)+"项")]),a("a-button",{attrs:{type:"primary"},on:{click:e.selectAllClick}},[e._v("审批")])],1):e._e(),a("a-table",{staticClass:"table",attrs:{columns:e.columns,"row-selection":{selectedRowKeys:e.selectedRowKeys,onChange:e.onSelectChange},pagination:e.pagination,rowKey:function(e,t){return t},"data-source":e.data,size:"small"},on:{change:e.handleTableChange},scopedSlots:e._u([{key:"startTime",fn:function(t,n){return a("span",{},[[a("span",[e._v(e._s(n.startTime)+" "),a("br"),e._v("至 "+e._s(n.endTime))])]],2)}},{key:"status",fn:function(t,n){return a("span",{},[[a("span",[e._v(e._s(0==n.status?"未开始":""))]),a("span",[e._v(e._s(1==n.status?"进行中":""))]),a("span",[e._v(e._s(2==n.status?"进行中":""))])]],2)}},{key:"action",fn:function(t,n){return a("span",{},[[a("a",{on:{click:function(t){return e.actionClick("审核",n)}}},[e._v("审核")]),a("a-divider",{attrs:{type:"vertical"}}),a("a",{on:{click:function(t){return e.actionClick("查看",n)}}},[e._v("查看")])]],2)}}])}),a("Create",{ref:"Create"})],1)])},i=[],r=(a("b0c0"),a("159b"),a("a15b"),a("eec7")),s=a("b28e"),c=[{title:"#",scopedSlots:{customRender:"serial"}},{dataIndex:"appletsName",key:"appletsName",title:"分公司小程序名称",scopedSlots:{customRender:"name"}},{title:"活动名称",dataIndex:"name",key:"name"},{title:"有效时间",dataIndex:"startTime",key:"startTime",scopedSlots:{customRender:"startTime"}},{title:"活动状态",key:"status",dataIndex:"status",scopedSlots:{customRender:"status"}},{title:"总部审批",key:"approvalStatusNote",dataIndex:"approvalStatusNote",scopedSlots:{customRender:"approvalStatusNote"}},{title:"操作",key:"actions",dataIndex:"action",scopedSlots:{customRender:"action"}}],o={data:function(){return{selectedRowKeys:[],selectedAll:[],data:[],columns:c,visible:!1,postApplyState:"0",pagination:{total:0,pageSize:10},page:1,tabKey:null,appletsManageId:1,name:null,type:7,recordrow:null,userName:storage.get("user").userName}},components:{Create:s["default"]},created:function(){this.initActivityManage()},methods:{handleChange:function(e){console.log(e),this.name=e},handleTableChange:function(e){console.log(e),this.page=e.current,this.pagination.total=e.pageSize,this.initActivityManage()},tabClick:function(e){this.tabKey=e,console.log(e),this.initActivityManage()},initActivityManage:function(){var e=this,t={approvalStatus:this.tabKey,page:this.page,pageSize:this.pagination.pageSize};Object(r["b"])(t).then((function(t){e.data=t.data,console.log(t),e.pagination.total=t.totalSize,e.pagination.page=t.currentPage}))},buttonActiveClick:function(e){"重置"==e?(this.name=null,this.appletsManageId="",this.tabKey=0):this.initActivityManage()},selectAllClick:function(){console.log(),this.visible=!0},actionClick:function(e,t){"查看"==e?this.$refs.Create.open("详情",t):(console.log(t),this.recordrow=t,this.visible=!0)},onSelectChange:function(e,t){console.log(e,t),this.selectedRowKeys=e,this.selectedAll=t,console.log(this.selectedAll)},handleApplyOk:function(){this.visible=!1},changeApplyState:function(e){var t=this;console.log(e),console.log(this.recordrow);var a,n=[],i=[];this.recordrow&&(a={fieldName:"id",fieldValue:this.recordrow.id}),this.selectedAll.length>0&&(this.selectedAll.forEach((function(e){e.id&&i.push(e.id)})),a={fieldName:"id",fieldValue:i.join(",")});var s={fieldName:"approval_status",fieldValue:e},c={fieldName:"approval_user",fieldValue:this.userName};n.push(a,s,c);var o={moduleFields:n,name:"activity_head_batch"};Object(r["c"])(o).then((function(e){t.visible=!1,t.selectedAll=[],t.initActivityManage()}))}},watch:{visible:function(){this.visible||(this.postApplyState=0)}}},l=o,u=(a("a309"),a("2877")),d=Object(u["a"])(l,n,i,!1,null,"ac974ba0",null);t["default"]=d.exports},"2e3c":function(e,t,a){},"2ee7":function(e,t,a){},5899:function(e,t){e.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(e,t,a){var n=a("1d80"),i=a("5899"),r="["+i+"]",s=RegExp("^"+r+r+"*"),c=RegExp(r+r+"*$"),o=function(e){return function(t){var a=String(n(t));return 1&e&&(a=a.replace(s,"")),2&e&&(a=a.replace(c,"")),a}};e.exports={start:o(1),end:o(2),trim:o(3)}},7156:function(e,t,a){var n=a("861d"),i=a("d2bb");e.exports=function(e,t,a){var r,s;return i&&"function"==typeof(r=t.constructor)&&r!==a&&n(s=r.prototype)&&s!==a.prototype&&i(e,s),e}},a15b:function(e,t,a){"use strict";var n=a("23e7"),i=a("44ad"),r=a("fc6a"),s=a("a640"),c=[].join,o=i!=Object,l=s("join",",");n({target:"Array",proto:!0,forced:o||!l},{join:function(e){return c.call(r(this),void 0===e?",":e)}})},a309:function(e,t,a){"use strict";a("2e3c")},a9e3:function(e,t,a){"use strict";var n=a("83ab"),i=a("da84"),r=a("94ca"),s=a("6eeb"),c=a("5135"),o=a("c6b6"),l=a("7156"),u=a("c04e"),d=a("d039"),p=a("7c73"),f=a("241c").f,m=a("06cf").f,v=a("9bf2").f,b=a("58a8").trim,h="Number",y=i[h],g=y.prototype,_=o(p(g))==h,k=function(e){var t,a,n,i,r,s,c,o,l=u(e,!1);if("string"==typeof l&&l.length>2)if(l=b(l),t=l.charCodeAt(0),43===t||45===t){if(a=l.charCodeAt(2),88===a||120===a)return NaN}else if(48===t){switch(l.charCodeAt(1)){case 66:case 98:n=2,i=49;break;case 79:case 111:n=8,i=55;break;default:return+l}for(r=l.slice(2),s=r.length,c=0;c<s;c++)if(o=r.charCodeAt(c),o<48||o>i)return NaN;return parseInt(r,n)}return+l};if(r(h,!y(" 0o1")||!y("0b1")||y("+0x1"))){for(var w,C=function(e){var t=arguments.length<1?0:e,a=this;return a instanceof C&&(_?d((function(){g.valueOf.call(a)})):o(a)!=h)?l(new y(k(t)),a,C):k(t)},A=n?f(y):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger,fromString,range".split(","),x=0;A.length>x;x++)c(y,w=A[x])&&!c(C,w)&&v(C,w,m(y,w));C.prototype=g,g.constructor=C,s(i,h,C)}},b28e:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-modal",{staticClass:"height-modal",attrs:{wrapClassName:"full-modal-wrap"+(e.disabled?" no-footer":""),title:e.type,destroyOnClose:!0,visible:e.visible,width:"60%",okText:"提交",footer:e.disabled||void 0},on:{cancel:e.close}},[a("ActivityInfo",{ref:"ActivityInfo",attrs:{record:e.record,disabled:e.disabled}}),a("ActivityDetail",{ref:"ActivityDetail",attrs:{record:e.record,disabled:e.disabled}}),a("ActivityRule",{ref:"ActivityRule",attrs:{record:e.record,disabled:e.disabled}}),e.disabled?e._e():a("template",{slot:"footer"},[a("a-button",{key:"back",on:{click:e.close}},[e._v(" 取消 ")]),a("a-button",{key:"submit",attrs:{type:"primary"},on:{click:e.handleOk}},[e._v(" 提交 ")])],1)],2)},i=[],r=a("5530"),s=a("1da1"),c=(a("96cf"),a("caad"),a("2532"),a("4fa5")),o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("baseCard",{attrs:{title:"活动详情页面管理"}},[a("a-form-model",{ref:"dynamicValidateForm",attrs:{model:e.dynamicValidateForm,"label-col":{span:4},"wrapper-col":{span:19}}},[e._l(e.dynamicValidateForm.domains,(function(t,n){return a("a-form-model-item",{key:t.key,attrs:{label:t.label,required:!0}},[a("a-row",[a("a-col",{attrs:{span:18}},[1===t.type?a("a-input",{attrs:{placeholder:"请输入",disabled:e.disabled},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"domain.value"}}):2===t.type?a("a-textarea",{attrs:{placeholder:"请输入","allow-clear":"",disabled:e.disabled,"auto-size":{minRows:2,maxRows:6}},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"domain.value"}}):a("ImgUpload",{attrs:{disabled:e.disabled},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"domain.value"}}),a("div",{staticClass:"err"},[e._v(e._s(t.err))])],1),e.disabled?e._e():a("a-col",{staticStyle:{"padding-left":"10px"},attrs:{span:6}},[t.down?a("span",[a("a-icon",{attrs:{type:"arrow-down"},on:{click:function(a){return e.swap("down",n,t)}}}),e._v(" "),a("a-divider",{attrs:{type:"vertical"}})],1):e._e(),t.up?a("span",[a("a-icon",{attrs:{type:"arrow-up"},on:{click:function(a){return e.swap("up",n,t)}}}),e._v(" "),a("a-divider",{attrs:{type:"vertical"}})],1):e._e(),a("a-icon",{attrs:{type:"minus-circle-o"},on:{click:function(t){return e.del(n)}}})],1)],1)],1)})),a("a-row",[a("a-col",{attrs:{span:4}}),a("a-col",{attrs:{span:14}},[a("a-dropdown",{attrs:{disabled:e.disabled}},[a("a-menu",{attrs:{slot:"overlay"},on:{click:e.create},slot:"overlay"},e._l(e.menu,(function(t){return a("a-menu-item",{key:t.value+"-"+t.label},[e._v(" "+e._s(t.label)+" ")])})),1),a("a-button",[e._v(" 添加内容 "),a("a-icon",{attrs:{type:"down"}})],1)],1)],1)],1)],2)],1)},l=[],u=a("3835"),d=(a("d81d"),a("d3b7"),a("159b"),a("a434"),a("1276"),a("ac1f"),a("a9e3"),a("f6ef")),p=a("cd3f"),f=a.n(p),m=a("d549"),v=a("ca00"),b={name:"activityDetail",components:{baseCard:d["a"],ImgUpload:m["a"]},props:["record","disabled"],data:function(){return{formItemLayout:{labelCol:{xs:{span:24},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:20}}},formItemLayoutWithOutLabel:{wrapperCol:{xs:{span:24,offset:0},sm:{span:20,offset:4}}},dynamicValidateForm:{domains:[]},menu:[{value:1,label:"标题"},{value:2,label:"内容"},{value:3,label:"图片"}],rules:{}}},created:function(){var e;null!==(e=this.record)&&void 0!==e&&e.pageManagements?this.dynamicValidateForm.domains=Object(v["a"])(this.record.pageManagements.map((function(e,t){return{value:e.value,key:t,type:e.type,label:e.label,err:""}}))):this.dynamicValidateForm.domains=Object(v["a"])(this.menu.map((function(e){return{value:"",key:e.value,type:e.value,label:e.label,err:""}})))},methods:{check:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=e.dynamicValidateForm.domains,t.abrupt("return",new Promise((function(e){var t=!0;a.forEach((function(e){e.value?e.err="":(e.err="请填写",t=!1)})),e(!!t&&{pageManagements:a})})));case 2:case"end":return t.stop()}}),t)})))()},del:function(e){var t=f()(this.dynamicValidateForm.domains);t.splice(e,1),this.dynamicValidateForm.domains=Object(v["a"])(t)},create:function(e){var t=e.key,a=t.split("-"),n=Object(u["a"])(a,2),i=n[0],r=n[1],s=f()(this.dynamicValidateForm.domains);s.push({value:"",key:Date.now(),type:Number(i),label:r}),this.dynamicValidateForm.domains=Object(v["a"])(s)},swap:function(e,t,a){var n=f()(this.dynamicValidateForm.domains);"up"===e?Object(v["d"])(n,t,t-1):Object(v["d"])(n,t,t+1),this.dynamicValidateForm.domains=Object(v["a"])(n)}}},h=b,y=(a("197f"),a("2877")),g=Object(y["a"])(h,o,l,!1,null,"41b0fbca",null),_=g.exports,k=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("baseCard",{attrs:{title:"活动规则管理"}},[a("a-form-model",{ref:"ruleForm",attrs:{rules:e.rules,model:e.form,"label-col":{span:4},"wrapper-col":{span:14}}},[a("a-form-model-item",{attrs:{label:"标题",prop:"title"}},[a("a-input",{attrs:{placeholder:"请输入",disabled:e.disabled},model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1),a("a-form-model-item",{attrs:{label:"内容",prop:"content"}},[a("a-textarea",{attrs:{placeholder:"请输入","allow-clear":"",disabled:e.disabled,"auto-size":{minRows:2,maxRows:6}},model:{value:e.form.content,callback:function(t){e.$set(e.form,"content",t)},expression:"form.content"}})],1)],1)],1)},w=[],C={title:"",content:""},A={name:"activityRule",components:{baseCard:d["a"]},props:["record","disabled"],data:function(){return{form:f()(C),rules:{title:[{required:!0,message:"请输入",trigger:"blur"}],content:[{required:!0,message:"请选择",trigger:"blur"}]}}},created:function(){if(this.record&&this.record.ruleManagement){var e=this.record.ruleManagement,t=e.title,a=e.content;this.form={title:t,content:a}}},methods:{check:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t){e.$refs.ruleForm.validate((function(a){return t(!!a&&{ruleManagement:e.form})}))})));case 1:case"end":return t.stop()}}),t)})))()}}},x=A,O=Object(y["a"])(x,k,w,!1,null,null,null),j=O.exports,I=a("fad4"),N={name:"create",components:{ActivityInfo:c["a"],ActivityDetail:_,ActivityRule:j},props:["parent"],data:function(){return{visible:!1,type:"新建充值有礼",record:null}},computed:{disabled:function(){return this.type.includes("详情")}},mounted:function(){},methods:{handleOk:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var a,n,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$refs.ActivityInfo.check();case 2:return a=t.sent,t.next=5,e.$refs.ActivityDetail.check();case 5:return n=t.sent,t.next=8,e.$refs.ActivityRule.check();case 8:i=t.sent,n&&a&&i&&(e.visible=!1,"新建充值有礼"===e.type?Object(I["a"])(Object(r["a"])(Object(r["a"])(Object(r["a"])({},n),a),i)).then((function(t){e.$message.success("新建成功"),e.parent.refresh()})):Object(I["c"])(Object(r["a"])(Object(r["a"])(Object(r["a"])(Object(r["a"])({},n),a),i),{},{id:e.record.id})).then((function(t){e.$message.success("更新成功"),e.parent.refresh()})));case 10:case"end":return t.stop()}}),t)})))()},close:function(){this.visible=!1},open:function(e,t){this.visible=!0,this.type=e,this.record=t}}},S=N,R=(a("f7be"),Object(y["a"])(S,n,i,!1,null,"59ae30c7",null));t["default"]=R.exports},eec7:function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"c",(function(){return r})),a.d(t,"b",(function(){return s}));var n=a("b775");function i(e){return Object(n["a"])({url:"/v1/activitys/_search",method:"post",data:e,headers:{"Content-Type":"application/json"}})}function r(e){return Object(n["a"])({url:"/v1/activitys/_update",method:"put",data:e,headers:{"Content-Type":"application/json"}})}function s(e){return Object(n["a"])({url:"v1/activitys/recharge/_search",method:"post",data:e,headers:{"Content-Type":"application/json"}})}},f7be:function(e,t,a){"use strict";a("fbd2")},fad4:function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"a",(function(){return r})),a.d(t,"c",(function(){return s}));var n=a("b775");function i(e){var t=e.cc_you_xiao,a=e.createTime;return t&&2===t.length&&(e.esDate=t[0]+" 00:00:00",e.eeDate=t[1]+" 23:59:59",delete e.cc_you_xiao),a&&2===a.length&&(e.csDate=a[0]+" 00:00:00",e.ceDate=a[1]+" 23:59:59",delete e.createTime),Object(n["a"])({url:"/v1/activitys/recharge/_search",method:"post",data:e})}function r(e){return Object(n["a"])({url:"/v1/activity/recharge",method:"post",data:e})}function s(e){return Object(n["a"])({url:"/v1/activity/recharge/"+e.id,method:"put",data:e})}},fbd2:function(e,t,a){}}]);