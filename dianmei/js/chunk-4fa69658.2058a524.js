(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4fa69658"],{"173d":function(t,e,a){"use strict";a.d(e,"a",(function(){return s})),a.d(e,"c",(function(){return i})),a.d(e,"b",(function(){return c})),a.d(e,"d",(function(){return o}));var n=a("b775");function s(t){return Object(n["a"])({url:"/v1/module/memberBenefits/".concat(t.companyId,"/detail"),method:"get"})}function i(t){return Object(n["a"])({url:"v1/module/_update",method:"PUT",data:JSON.stringify(t),headers:{"Content-Type":"application/json"}})}function c(t,e){return Object(n["a"])({url:"/v1/module/memberBenefits/".concat(t),method:"PUT",data:JSON.stringify(e),headers:{"Content-Type":"application/json"}})}function o(t){return Object(n["a"])({url:"/v1/card/type/list",method:"post",data:JSON.stringify(t),headers:{"Content-Type":"application/json"}})}},"60e1":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("a-modal",{attrs:{title:"编辑会员卡",destroyOnClose:!0,visible:t.visible,width:"80%",okText:"提交"},on:{ok:t.handleOk,cancel:t.handleCancel}},[a("div",{staticClass:"border-top"},[a("div",{staticClass:"column"},[t._v("为你推荐-栏位")]),a("div",{staticClass:"column-r"},[a("div",{staticClass:"label"},[t._v("*栏位标题")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.cardInfo.title,expression:"cardInfo.title"}],attrs:{type:"text",placeholder:"请输入标题"},domProps:{value:t.cardInfo.title},on:{input:function(e){e.target.composing||t.$set(t.cardInfo,"title",e.target.value)}}})])]),a("div",{staticClass:"row-title"},[a("span",[t._v("选择推荐会员卡")]),a("a-button",{staticClass:"select-text",attrs:{type:"primary"},on:{click:t.selectClick}},[a("a-icon",{attrs:{type:"left"}}),t._v("选择卡类型 ")],1)],1),a("a-list",{staticClass:"list",attrs:{"item-layout":"horizontal","data-source":t.cardInfo.cardList},scopedSlots:t._u([{key:"renderItem",fn:function(e,n){return a("a-list-item",{staticClass:"renderItem"},[a("img",{attrs:{src:e.cardImage,alt:""}}),a("div",{staticClass:"left"},[a("p",{staticClass:"cardName"},[t._v(t._s(e.cardTypeName))]),a("p",{staticClass:"price"},[t._v("￥"+t._s(e.cardDefaultAmount))])]),a("div",{staticClass:"config"},[a("a",{on:{click:function(a){return t.cardDelect(e,n)}}},[t._v("删除")])])])}}])}),a("div",{staticClass:"date-row-title"},[t._v("选择生效时间：")]),a("a-range-picker",{staticClass:"range-picker",attrs:{"show-time":"",format:"YYYY-MM-DD HH:mm:ss",placeholder:[t.cardInfo.startTime,t.cardInfo.endTime]},on:{change:t.onChange}}),a("div",{staticClass:"date-row-title"},[t._v("选择上下架：")]),a("a-radio-group",{on:{change:t.radioOnChange},model:{value:t.status,callback:function(e){t.status=e},expression:"status"}},[a("a-radio",{attrs:{value:1}},[t._v(" 上架 ")]),a("a-radio",{attrs:{value:0}},[t._v(" 下架 ")])],1),a("a-modal",{attrs:{title:"选择会员卡列表",destroyOnClose:!0,visible:t.visibleModal,width:"50%",okText:"提交"},on:{ok:t.handleModalOk,cancel:t.handleModalCancel}},[a("div",{staticClass:"top-title"},[t._v("选择会员卡")]),a("a-input-search",{staticStyle:{width:"600px","margin-bottom":"10px"},attrs:{placeholder:"搜索会员卡编号","enter-button":""},on:{search:t.onSearch},model:{value:t.nameOrCode,callback:function(e){t.nameOrCode=e},expression:"nameOrCode"}}),a("a-table",{staticClass:"card-table",attrs:{size:"small",pagination:!0,"row-key":"record.cardTypeId",columns:t.searchColumns,"data-source":t.searchList},scopedSlots:t._u([{key:"action",fn:function(e,n,s){return a("span",{},[[a("a",{on:{click:function(e){return t.actionAddClick("添加",n,s)}}},[t._v("添加")])]],2)}}])}),t.sectleCardList&&t.sectleCardList.length>0?a("div",{staticClass:"top-title"},[t._v("已选择会员卡")]):t._e(),t.sectleCardList&&t.sectleCardList.length>0?a("a-table",{staticClass:"sectleCardList-table",attrs:{size:"small",pagination:!1,scroll:{x:430,y:400},"row-key":"record.cardTypeId",columns:t.cardColumns,"data-source":t.sectleCardList},scopedSlots:t._u([{key:"action",fn:function(e,n,s){return a("span",{},[[a("a",{on:{click:function(e){return t.actionDelectClick("删除",n,s)}}},[t._v("删除")])]],2)}}],null,!1,2529372193)}):t._e()],1)],1)},s=[],i=(a("a434"),a("4de4"),a("159b"),a("173d")),c={name:"miniMemberEdit",components:{},data:function(){return{visible:!1,visibleModal:!1,cardInfo:{cardList:[],title:""},status:0,cardColumns:[{title:"会员名",dataIndex:"cardTypeName",key:"cardTypeName"},{title:"操作",dataIndex:"action",key:"action",scopedSlots:{customRender:"action"},width:"20%"}],searchColumns:[{title:"会员名",dataIndex:"cardTypeName",key:"cardTypeName"},{title:"操作",dataIndex:"action",key:"action",scopedSlots:{customRender:"action"},width:"20%"}],searchList:null,sectleCardList:[],nameOrCode:null}},created:function(){},mounted:function(){},methods:{initEdit:function(t){console.log(t),t&&(this.cardInfo=t,this.status=t.status)},onChange:function(t,e){this.cardInfo.startTime=e[0],this.cardInfo.endTime=e[1]},actionAddClick:function(t,e,a){var n=this.sectleCardList||[];if(0==n.length)n.push(e);else{this.searchList.splice(a,1);var s=n.filter((function(t){return t.cardTypeId==e.cardTypeId})).length;0==s&&n.push(e)}this.sectleCardList=n},initManagementList:function(){var t=this,e={companyId:33,nameOrCode:this.nameOrCode};Object(i["d"])(e).then((function(e){t.searchList=e,t.cardInfo.cardList&&t.cardInfo.cardList.length>0&&t.cardInfo.cardList.forEach((function(e){t.sectleCardList.push(e)})),t.nameOrCode=""}))},onSearch:function(t){this.nameOrCode=t,this.initManagementList()},cardDelect:function(t,e){this.cardInfo.cardList.length>1?this.cardInfo.cardList.splice(e,1):this.$message.error("请选择2张为你推荐会员卡")},actionDelectClick:function(t,e,a){console.log(t,e,a),this.sectleCardList.splice(a,1)},selectClick:function(){this.initManagementList(),this.visibleModal=!0},radioOnChange:function(t){this.status=t.target.value},handleOk:function(){var t=this;if(this.cardInfo.title){if(this.cardInfo.cardList.length<1)return this.$message.error("请选择2张为你推荐会员卡");this.cardInfo.status=this.status,Object(i["b"])(this.cardInfo.id,this.cardInfo).then((function(e){t.visible=!1}))}else this.$message.error("请输入标题")},handleCancel:function(){this.visible=!1},handleModalOk:function(){this.cardInfo.cardList=this.sectleCardList,this.visibleModal=!1,this.sectleCardList=[]},handleModalCancel:function(){this.visibleModal=!1,this.sectleCardList=[]}}},o=c,r=(a("ae4b"),a("2877")),l=Object(r["a"])(o,n,s,!1,null,"2a840585",null);e["default"]=l.exports},ae4b:function(t,e,a){"use strict";a("fa39")},fa39:function(t,e,a){}}]);