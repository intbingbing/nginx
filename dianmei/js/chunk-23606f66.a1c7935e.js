(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-23606f66"],{"3fe3":function(t,e,a){"use strict";a.d(e,"c",(function(){return o})),a.d(e,"d",(function(){return c})),a.d(e,"a",(function(){return s})),a.d(e,"g",(function(){return u})),a.d(e,"e",(function(){return l})),a.d(e,"h",(function(){return d})),a.d(e,"f",(function(){return f})),a.d(e,"b",(function(){return m}));a("159b"),a("4de4");var n=a("b775"),r=a("da46"),i=a("ca00");function o(t){return Object(n["a"])({url:"/v1/module/homepage/_search",method:"post",data:t}).then((function(t){if(t.forEach((function(t){var e=r["moduleType"].filter((function(e){return e.value===t.moduleType}));t.moduleNote=e[0].label})),t.length>2){for(var e=0;e<2;e++)t[e].up=t[e].down=!1;for(var a=[],n=2;n<t.length;n++)a.push(t[n]);Object(i["a"])(a)}else for(var o=0;o<t.length;o++)t[o].up=t[o].down=!1;return Object(i["g"])(t)}))}function c(t){return Object(n["a"])({url:"/v1/activitys/_search",method:"post",data:t})}function s(t){return Object(n["a"])({url:"/v1/module/homepage/addMarketing",method:"post",data:t})}function u(t){return Object(n["a"])({url:"/v1/module/homepage/update/".concat(t.id),method:"put",data:t})}var l=u;function d(t){return Object(n["a"])({url:"/v1/module/_update",method:"put",data:t})}function f(t){return Object(n["a"])({url:"/v1/activitys/_update",method:"put",data:t})}function m(t){return Object(n["a"])({url:"/v1/module/homepage/addGroup",method:"post",data:t})}},a15b:function(t,e,a){"use strict";var n=a("23e7"),r=a("44ad"),i=a("fc6a"),o=a("a640"),c=[].join,s=r!=Object,u=o("join",",");n({target:"Array",proto:!0,forced:s||!u},{join:function(t){return c.call(i(this),void 0===t?",":t)}})},d348:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("a-modal",{attrs:{title:t.type,destroyOnClose:!0,visible:t.visible,width:"60%",okText:"提交",wrapClassName:"full-modal-wrap"},on:{cancel:t.close}},[a("MarketingActivityInfo",{ref:"MarketingActivityInfo",attrs:{defaultData:t.defaultData}}),a("AddMarketingActivity",{ref:"AddMarketingActivity",attrs:{defaultData:t.defaultData}}),a("template",{slot:"footer"},[a("a-button",{key:"back",on:{click:t.close}},[t._v(" 取消 ")]),a("a-button",{key:"submit",attrs:{type:"primary",loading:t.loading},on:{click:t.handleOk}},[t._v(" 提交 ")])],1)],2)},r=[],i=a("5530"),o=a("1da1"),c=(a("96cf"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("baseCard",{attrs:{title:"营销活动模块信息"}},[a("a-form-model",{ref:"ruleForm",attrs:{rules:t.rules,model:t.form,layout:"inline"}},[a("a-row",{attrs:{gutter:20}},[a("a-col",{attrs:{span:12}},[a("a-form-model-item",{attrs:{label:"标题",prop:"title"}},[a("a-input",{staticStyle:{width:"300px"},attrs:{placeholder:"请输入"},model:{value:t.form.title,callback:function(e){t.$set(t.form,"title",e)},expression:"form.title"}})],1)],1),a("a-col",{attrs:{span:12}},[a("a-form-model-item",{attrs:{label:"上架",prop:"status"}},[a("a-radio-group",{model:{value:t.form.status,callback:function(e){t.$set(t.form,"status",e)},expression:"form.status"}},[a("a-radio",{attrs:{value:1}},[t._v(" 上架 ")]),a("a-radio",{attrs:{value:0}},[t._v(" 下架 ")])],1)],1)],1)],1)],1)],1)}),s=[],u=(a("d3b7"),a("f6ef")),l=a("cd3f"),d=a.n(l),f={title:"",status:1},m={name:"marketingActivityInfo",components:{baseCard:u["a"]},props:["defaultData"],data:function(){return{form:d()(f),rules:{title:[{required:!0,message:"请输入",trigger:"blur"}],status:[{required:!0,message:"请选择",trigger:"blur"}]}}},created:function(){if(this.defaultData){var t=this.defaultData,e=t.title,a=t.status;this.form={title:e,status:a}}},methods:{check:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){t.$refs.ruleForm.validate((function(a){return e(!!a&&t.form)}))})));case 1:case"end":return e.stop()}}),e)})))()}}},p=m,h=a("2877"),b=Object(h["a"])(p,c,s,!1,null,null,null),v=b.exports,y=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("baseCard",{attrs:{title:"添加营销活动"}},[a("a-button",{staticClass:"margin-bottom-10",attrs:{type:"primary",icon:"plus"},on:{click:t.selectActivity}},[t._v(" 选择营销活动 ")]),a("a-table",{ref:"table",attrs:{rowKey:"id",columns:t.columns,dataSource:t.tableData,pagination:!1,size:"small"},scopedSlots:t._u([{key:"action",fn:function(e,n,r){return a("span",{},[[n.down?a("span",[a("a-icon",{attrs:{type:"arrow-down"},on:{click:function(e){return t.swap("down",r,n)}}}),t._v(" "),a("a-divider",{attrs:{type:"vertical"}})],1):t._e(),n.up?a("span",[a("a-icon",{attrs:{type:"arrow-up"},on:{click:function(e){return t.swap("up",r,n)}}}),t._v(" "),a("a-divider",{attrs:{type:"vertical"}})],1):t._e(),a("a-icon",{attrs:{type:"delete"},on:{click:function(e){return t.del(n)}}})]],2)}}])}),a("ActivityList",{ref:"ActivityList",on:{ok:t.setActivityList}})],1)},g=[],k=(a("99af"),a("a15b"),a("d81d"),a("a434"),a("c740"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("BaseModal",{ref:"BaseModal",attrs:{title:"选择活动列表",showSearch:!1},on:{ok:t.handleOk}},[a("s-table",{ref:"table",attrs:{rowKey:"id",size:"small",columns:t.columns,data:t.loadData,condition:t.condition,"row-selection":t.rowSelection}})],1)}),w=[],O=(a("b0c0"),a("c593")),j=a("ab09"),D=a("3fe3"),A={name:"SelectActivity",components:{BaseModal:O["a"],STable:j["a"]},data:function(){return{columns:[{title:"活动名称",dataIndex:"name"},{title:"有效期",customRender:function(t,e,a){return"".concat(e.startTime,"至").concat(e.endTime)}}],condition:[{title:"活动名称",dataIndex:"name",type:"input",span:16}],loadData:function(t){return Object(D["d"])(Object(i["a"])(Object(i["a"])({},t),{},{type:3}))},selectList:[]}},computed:{rowSelection:function(){var t=this;return{onChange:function(e,a){t.selectList=a},getCheckboxProps:function(t){return{props:{disabled:"Disabled User"===t.name,name:t.name}}},selectedRowKeys:this.selectList.map((function(t){return t.id}))}}},created:function(){},mounted:function(){},methods:{handleOk:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.$emit("ok",t.selectList);case 1:case"end":return e.stop()}}),e)})))()},open:function(t,e){this.selectList=t,this.params={type:e.value},this.$refs.BaseModal.open()}}},_=A,x=Object(h["a"])(_,k,w,!1,null,"14c99320",null),$=x.exports,M=a("ca00"),L={name:"addMarketingActivity",components:{baseCard:u["a"],ActivityList:$},props:["defaultData"],data:function(){return{tableData:[],columns:[{title:"活动名称",dataIndex:"name"},{title:"有效期",customRender:function(t,e,a){return"".concat(e.startTime,"至").concat(e.endTime)}},{title:"操作",dataIndex:"action",scopedSlots:{customRender:"action"}}]}},mounted:function(){var t;null!==this&&void 0!==this&&null!==(t=this.defaultData)&&void 0!==t&&t.activityList&&(this.tableData=Object(M["a"])(this.defaultData.activityList))},methods:{selectActivity:function(t){this.$refs.ActivityList.open(this.tableData,t)},setActivityList:function(t){this.tableData=Object(M["a"])(t)},check:function(){return this.tableData.length?{content_id:this.tableData.map((function(t){return t.id})).join()}:(this.$message.error("请选择营销活动！"),!1)},action:function(t,e,a){"删除"===t&&this.tableData.splice(a,1)},del:function(t){var e=d()(this.tableData);e.splice(e.findIndex((function(e){return t.id===e.id})),1),this.tableData=Object(M["a"])(e)},swap:function(t,e,a){var n=d()(this.tableData);"up"===t?Object(M["d"])(n,e,e-1):Object(M["d"])(n,e,e+1),this.tableData=Object(M["a"])(n)}}},I=L,R=Object(h["a"])(I,y,g,!1,null,null,null),C=R.exports,S={components:{MarketingActivityInfo:v,AddMarketingActivity:C},name:"marketingActivity",props:["parent"],data:function(){return{visible:!1,type:"拼团",record:null,loading:!1,defaultData:{}}},created:function(){},mounted:function(){},methods:{handleOk:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){var a,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$refs.MarketingActivityInfo.check();case 2:return a=e.sent,e.next=5,t.$refs.AddMarketingActivity.check();case 5:n=e.sent,a&&n&&(t.visible=!1,"新增营销活动"===t.type?Object(D["a"])(Object(i["a"])(Object(i["a"])({},a),n)).then((function(e){t.$message.success("新建成功"),t.parent.refresh()})):Object(D["e"])(Object(i["a"])(Object(i["a"])(Object(i["a"])({},a),n),{},{id:t.defaultData.id})).then((function(e){t.$message.success("更新成功"),t.parent.refresh()})));case 7:case"end":return e.stop()}}),e)})))()},close:function(){this.visible=!1},open:function(t,e){this.visible=!0,this.type=t+"营销活动",this.record=e,this.defaultData="编辑"===t?d()(e):null}}},T=S,E=Object(h["a"])(T,n,r,!1,null,"58bf3248",null);e["default"]=E.exports}}]);