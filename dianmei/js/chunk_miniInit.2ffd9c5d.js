(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk_miniInit","chunk-2d0a423c"],{"04bd":function(e,t,a){"use strict";a.r(t),a.d(t,"columns",(function(){return r})),a.d(t,"condition",(function(){return o}));var r=[{title:"#",scopedSlots:{customRender:"serial"},width:60},{title:"小程序名称",dataIndex:"appletsName"},{title:"区域",dataIndex:"area"},{title:"Appid",dataIndex:"appId"},{title:"作用范围",dataIndex:"companyName"},{title:"活动是否需要审批",dataIndex:"activityApprovalNote"},{title:"状态",dataIndex:"statusNote",width:60},{title:"创建人",dataIndex:"userName",width:90},{title:"操作",dataIndex:"action",scopedSlots:{customRender:"action"}}],o=[{title:"小程序名称",dataIndex:"appletsName",type:"input"},{title:"状态",dataIndex:"status",type:"select",defaultValue:"",options:[{label:"关闭",value:0},{label:"启用",value:1}]}]},"22a9":function(e,t,a){"use strict";a("f2cb")},7809:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-modal",{attrs:{title:e.type,visible:e.visible,width:"50%",wrapClassName:"full-modal-wrap"},on:{cancel:e.close}},[a("a-form-model",{ref:"ruleForm",attrs:{model:e.form,rules:e.rules,"label-col":{span:6},"wrapper-col":{span:16}}},[a("a-form-model-item",{attrs:{label:"分公司小程序",prop:"appletsName"}},[a("a-input",{attrs:{placeholder:"请输入"},model:{value:e.form.appletsName,callback:function(t){e.$set(e.form,"appletsName",t)},expression:"form.appletsName"}})],1),a("a-form-model-item",{attrs:{label:"AppID",prop:"appId"}},[a("a-input",{attrs:{placeholder:"请输入"},model:{value:e.form.appId,callback:function(t){e.$set(e.form,"appId",t)},expression:"form.appId"}})],1),a("a-form-model-item",{attrs:{label:"Code",prop:"code"}},[a("a-input",{attrs:{placeholder:"请输入",disabled:"编辑"===e.type},model:{value:e.form.code,callback:function(t){e.$set(e.form,"code",t)},expression:"form.code"}})],1),a("a-form-model-item",{attrs:{label:"状态",prop:"status"}},[a("a-select",{attrs:{placeholder:"请选择"},model:{value:e.form.status,callback:function(t){e.$set(e.form,"status",t)},expression:"form.status"}},e._l(e.$dict.status,(function(t){return a("a-select-option",{key:t.value,attrs:{value:t.value}},[e._v(e._s(t.label))])})),1)],1),a("a-form-model-item",{attrs:{label:"活动是否需要审批",prop:"activityApproval"}},[a("a-select",{attrs:{placeholder:"请选择"},model:{value:e.form.activityApproval,callback:function(t){e.$set(e.form,"activityApproval",t)},expression:"form.activityApproval"}},e._l(e.$dict.activityApproval,(function(t){return a("a-select-option",{key:t.value,attrs:{value:t.value}},[e._v(e._s(t.label))])})),1)],1),a("a-form-model-item",{attrs:{label:"区域名称",prop:"area"}},[a("a-input",{attrs:{placeholder:"请输入"},model:{value:e.form.area,callback:function(t){e.$set(e.form,"area",t)},expression:"form.area"}})],1),a("div",{staticClass:"scroll"},[a("a-form-model-item",{attrs:{label:"作用范围",prop:"companyIds"}},[a("a-tree",{attrs:{checkable:"","auto-expand-parent":!0,"tree-data":e.treeData,"show-line":!0,"show-icon":!0,replaceFields:e.replaceFields},model:{value:e.form.companyIds,callback:function(t){e.$set(e.form,"companyIds",t)},expression:"form.companyIds"}})],1)],1)],1),a("template",{slot:"footer"},[a("a-button",{key:"back",on:{click:e.close}},[e._v(" 取消 ")]),a("a-button",{key:"submit",attrs:{type:"primary",loading:e.loading},on:{click:e.handleOk}},[e._v(" 提交 ")])],1)],2)},o=[],n=a("5530"),s=(a("159b"),a("b0c0"),a("d3b7"),a("d81d"),a("1276"),a("ac1f"),a("a9e3"),a("b64b"),a("8635")),l=a("ca00"),i=a("cd3f"),c=a.n(i),u={appletsName:"",status:void 0,activityApproval:void 0,appId:"",area:"",companyIds:[],code:""},d={data:function(){return{visible:!1,type:"新建",labelCol:{span:4},wrapperCol:{span:14},other:"",form:c()(u),rules:{appletsName:[{required:!0,message:"请输入",trigger:"blur"},{max:50,message:"长度不能超过50",trigger:"blur"}],status:[{required:!0,message:"请选择",trigger:"blur"}],activityApproval:[{required:!0,message:"请选择",trigger:"blur"}],appId:[{required:!0,message:"请输入",trigger:"blur"},{required:!0,validator:function(e,t,a){/^[0-9a-zA-Z]+$/.test(t)||a(new Error("限制字母或数字")),a()},trigger:"blur"}],code:[{required:!0,message:"请输入",trigger:"blur"},{validator:function(e,t,a){/^[0-9a-zA-Z]+$/.test(t)||a(new Error("限制字母或数字")),a()},trigger:"blur"},{max:10,message:"长度不能超过10",trigger:"blur"}],area:[{required:!0,message:"请输入",trigger:"blur"},{max:50,message:"长度不能超过50",trigger:"blur"}],companyIds:[{required:!0,message:"请选择",trigger:"blur"}]},treeData:[],replaceFields:{children:"children",title:"name",key:"id"},record:{},loading:!1}},created:function(){console.log(this.record)},mounted:function(){},methods:{handleOk:function(){var e=this;this.$refs.ruleForm.validate((function(t){if(!t)return console.log("error submit!!"),!1;e.loading=!0;var a={};e.form.companyIds.forEach((function(t){var r=Object(l["c"])(t,e.treeData);a[r.id]=r.name})),"编辑"===e.type?Object(s["e"])(Object(n["a"])(Object(n["a"])({},e.form),{},{companyMap:a,id:e.record.id})).then((function(t){e.$message.success("更新成功"),e.$parent.refresh(),e.visible=!1})).catch((function(e){})).finally((function(){e.loading=!1})):Object(s["a"])(Object(n["a"])(Object(n["a"])({},e.form),{},{companyMap:a})).then((function(t){e.$message.success("新建成功"),e.$parent.refresh(),e.visible=!1})).catch((function(e){})).finally((function(){e.loading=!1}))}))},close:function(){this.visible=!1,this.$refs.ruleForm.resetFields()},open:function(e,t){var a=this;this.visible=!0,this.type=e;var r=c()(t);this.record=r,"编辑"===e?(r.companyIds=r.companyIds?r.companyIds.split(",").map((function(e){return Number(e)})):[],Object.keys(u).forEach((function(e){return a.form[e]=r[e]}))):this.form=c()(u),Object(s["c"])({userId:2}).then((function(e){return a.treeData=e}))}}},p=d,m=(a("22a9"),a("2877")),f=Object(m["a"])(p,r,o,!1,null,"2e6369ae",null);t["default"]=f.exports},8635:function(e,t,a){"use strict";a.d(t,"b",(function(){return n})),a.d(t,"a",(function(){return s})),a.d(t,"e",(function(){return l})),a.d(t,"c",(function(){return i})),a.d(t,"d",(function(){return c}));var r=a("b775"),o=a("ca00");function n(e){return Object(r["a"])({url:"/v1/applets/_search",method:"post",data:e}).then((function(e){return Object(o["g"])(e)}))}function s(e){return Object(r["a"])({url:"/v1/applets",method:"post",data:e})}function l(e){return Object(r["a"])({url:"/v1/applets/"+e.id,method:"put",data:e})}function i(e){return Object(r["a"])({url:"/v1/tree/init",method:"GET",params:e})}function c(e){return Object(r["a"])({url:"/v1/applets/status/".concat(e.id),method:"put",data:e,headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}})}},"95ac":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"table-wrap"},[a("a-card",{attrs:{bordered:!1}},[a("s-table",{ref:"table",attrs:{rowKey:"id",columns:e.columns,data:e.loadData,condition:e.condition,showPagination:!1,scroll:{y:500}},scopedSlots:e._u([{key:"serial",fn:function(t,r,o){return a("span",{},[e._v(" "+e._s(o+1)+" ")])}},{key:"action",fn:function(t,r){return a("span",{},[[a("span",{on:{click:function(t){return e.action("编辑",r)}}},[a("a",[e._v("编辑")])]),a("a-divider",{attrs:{type:"vertical"}}),a("a-popconfirm",{attrs:{title:r.status?"确定关闭？":"确定启用？","ok-text":"是","cancel-text":"否"},on:{confirm:function(t){return e.action("切换状态",r)}}},[a("span",[a("a",[e._v(e._s(r.status?"关闭":"启用"))])])])]],2)}}])},[a("a-button",{staticStyle:{"margin-bottom":"10px"},attrs:{slot:"middle",type:"dashed",block:"",icon:"plus"},on:{click:function(t){return e.action("新建")}},slot:"middle"},[e._v(" 新建 ")])],1)],1),a("modal",{ref:"modal"})],1)},o=[],n=a("8635"),s=a("ab09"),l=a("04bd"),i=a("7809"),c={components:{STable:s["a"],modal:i["default"]},data:function(){var e=this;return{columns:l["columns"],queryParam:{},condition:l["condition"],loadData:function(t){return Object(n["b"])(Object.assign(t,e.queryParam))},visible:!0}},mounted:function(){},methods:{action:function(e,t){var a=this;"切换状态"===e?Object(n["d"])({id:t.id,status:t.status?0:1}).then((function(e){a.$message.success(t.status?"关闭成功":"启用成功"),a.$refs.table.refresh()})):this.$refs.modal.open(e,t)},refresh:function(){this.$refs.table.refresh()}}},u=c,d=a("2877"),p=Object(d["a"])(u,r,o,!1,null,null,null);t["default"]=p.exports},f2cb:function(e,t,a){}}]);